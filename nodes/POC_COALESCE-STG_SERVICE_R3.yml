fileVersion: 1
id: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
name: STG_SERVICE_R3
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: POC_COALESCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24cfe3c0-c7d9-4327-84e5-99e1386f748b
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: AUDIT_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1985a107-5dc1-4b04-be9a-caf581bd1eb3
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f266389-3dac-46ed-9f1e-c2db048eae60
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CF_SITE_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e2df71-fbb3-4841-8f46-58e7fe54eaf1
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2db3c2d-f4e8-4289-a920-57cf0f8502fe
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: DS_AGREEMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e9b19d-683c-4255-a77a-dfbd49141da5
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29ab2529-9ac7-4edc-aa21-7a9087d40954
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(128)
        description: ""
        name: DS_BPARTNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af34d97-0352-4400-ae9e-e56511f1bb90
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4b2d853-b72e-4fea-8a04-94f52f1a0640
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_MANAGING_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3573724-6eb9-48f0-bf10-591423c0ddeb
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 273c49eb-f182-40a8-b082-8c9a45e8d84b
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_OPERATIVE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0651f29e-485a-470d-a38e-50e713c77d40
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1146f543-3acb-4aa8-8397-583fcf603ed9
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_POP_ENERGY_INT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6ab3be2-de94-48b6-9695-c0e8377fface
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf94c2e8-5109-440c-a02a-03bc04be19d0
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ad199b5-2957-4663-a24a-4b10f7f05e14
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97b21e9f-538f-440a-b6b2-013e48f7e151
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5a9bbb2-50ac-4e68-b1e6-4ec52a3c7b42
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 533c39a7-4af8-449c-8e81-295ff1d97896
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d343e20-b625-4a03-aa79-25e16f225225
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7f42f41-8197-4185-b1ad-3ee4e06ea229
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: DS_STATUS_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7e9d589-3db0-46ca-90a8-4fa72a163fb9
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c31017a9-5a36-4f59-a9d3-121cff7fe7af
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DT_BATCH_IMPORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7ab3669-d882-4b7f-a617-2dcf6cb79e4f
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc9845ce-3f00-49c3-92ca-083099e89a0a
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_CHANGED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e596ffbe-539f-4416-9c5e-eaf221bfb7ac
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb9d977-6124-4486-963b-2f40daf6b3fe
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_CONTRACT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00e42efb-a79f-414f-be9b-c7cb4faf3846
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4df45e41-b009-43f2-bcc1-076d8aeb26b6
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9abfbd52-3f7f-4242-a86d-9a8138ef482e
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a060573-c5be-4aba-bf56-5ab719587682
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f617003f-40e2-4a33-93f9-af0079a72154
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 425fc6ca-5424-4578-aa38-7cc0368a2f56
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_EXECUTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8f94562-c3f5-4eac-a689-b7c38f2744ef
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 893df979-49f3-40bc-a905-9da4b143b120
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DT_MAJ_DATA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92587044-9d36-4804-9bd5-01e1d6a2885d
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ac61a4c-5b27-4c6e-aa76-d7a15b57e437
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: DATE
        description: ""
        name: DT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8685dd92-98ca-4879-b78c-77ed8ce95280
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4665094b-473c-4536-97b9-eaf4a4b6c839
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(128)
        description: ""
        name: ID_BPARTNER_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2487262c-c086-4df0-ac00-e2bad1b9e6fe
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90828bf0-7f51-4394-acdb-59350d30dc77
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_BP_STAKEHOLDER2_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d50f9cf-8f8c-4bfa-97b0-c0b939c6aaed
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a9f870e-39be-4458-9ce7-a795f7bccd53
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(120)
        description: ""
        name: ID_CELLNEX_COMPANY_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d14f845b-cc58-4630-a648-dc5e868cc0f9
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03895947-d994-4fc7-8d6d-e55715fba638
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_CONTRACT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc2abed2-9c1e-4fe5-bc8c-703cf59e687d
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aa3dc88-542d-474d-9ec0-0696e26634f2
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: ID_COUNTRY_SELLER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6860ed26-620a-4798-a1a3-a26f8d3773a5
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ee07fd7-1b08-4727-aba9-5dc4c00dad45
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: ID_INVOICING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 350e2b42-9820-42d2-a174-51b960447c68
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc8a1cd-b281-497d-a70a-9bf43023d147
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: ID_LEGACY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1429445-82be-49e5-be52-f4e466a034b4
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 844058a6-0371-4cc8-896a-4905e06d5cf5
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_MANAGING_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4335031-697e-4650-9f01-40624aac08bc
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a16b513-4c90-4f06-aca5-27b80b3d4d66
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(36)
        description: ""
        name: ID_MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89792f90-2170-454f-b034-72edb30e2415
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00965287-619a-4dc1-9a94-ad4a9cc0bdb1
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(128)
        description: ""
        name: ID_MATERIAL_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8e0b886-fbc4-45fc-8d58-d1c8c871b566
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62388586-b0ba-47fe-88e5-7bd0fc979837
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_METER_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82c95419-9757-411b-b624-6225f4e7124c
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 488e7a71-146e-4a56-a3ed-d98ff121139b
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: ID_OPERATIVE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92d35a9e-79bd-4145-bd53-00316a8f2184
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb368a8c-7da8-47a4-b9e8-65a0defea5bb
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d5b1553-2723-4cee-96ea-cb1dc3e06366
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b33358ae-1c7e-4e46-8e99-323d5b85ff08
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: key_service
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fe2c839-4849-4002-ba06-d462ae3efeb9
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc648fae-82f3-4d2b-87a3-96b1b44b3223
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ID_SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5638c7fd-b00d-4d62-9715-b54035593210
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef1803f1-d024-4f1f-bdf7-aed47465dc65
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(510)
        description: ""
        name: ID_STATUS_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1f0241b-f007-4e1a-b4ec-2f1e38019315
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a91275-f914-4fec-b450-51c5834a4287
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: ID_STATUS_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad3541c5-222e-4d47-8393-bd400d222cec
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b7c1721-748e-4a99-a43e-3771424189c1
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: id_client
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ba18b0c-1102-4cbf-ab34-77309957b7f9
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: |2-
                      DECODE("SERVICE_R3"."ID_BPARTNER",
                          '300026314', 'BOUYGUES TELECOM',
                          '300030584', 'FREE MOBILE',
                          '300043456', 'ORANGE',
                          '300030995', 'ORANGE',
                          '300026320', 'SFR',
                          'AUTRE') 
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 669a892d-c539-4977-a7e4-8987e1db2f9e
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: status_service
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15451ed4-bc26-4905-8109-a71fe5346ef1
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: |2-
                      DECODE("SERVICE_R3"."DS_INVOICING_STATUS",
                          null, 'Créé',
                          'Invoiced (One Off) / Being Invoiced (Recurrent)', 'Facturé',
                          'Partially invoiced (one-off)', 'Facturé partiel',
                          'Ready to Invoice', 'Ready to Invoice',
                          'Non-billable', 'Annulé')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26ca16ec-f516-445e-8cec-bb3c118bf004
          stepCounter: 85d9d0b8-9d37-409d-b2f2-f01a5d21f221
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: id_societe
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 245b3f0b-0253-40fd-a246-48535110851e
                stepCounter: 7332ac97-4164-4692-8199-a26ee872509b
            transform: |2-
                      DECODE("SERVICE_R3"."ID_CELLNEX_COMPANY",
                          '2101', 'Cellnex France',
                          '2105', 'On Tower France SAS',
                          '2108', 'Hivory SAS',
                          '2110', 'Cellnex FR Infrastructure'
                      )
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SERVICE_R3: 7332ac97-4164-4692-8199-a26ee872509b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: CAP_PRO
            nodeName: SERVICE_R3
        join:
          joinCondition: FROM {{ ref('CAP_PRO', 'SERVICE_R3') }} "SERVICE_R3"
        name: STG_SERVICE_R3
        noLinkRefs: []
  name: STG_SERVICE_R3
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
