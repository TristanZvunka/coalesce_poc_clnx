fileVersion: 1
id: b2ee19a7-6ecf-44c2-8959-934be8002105
name: STG_CHARACTERISTIC_PER_OBJECT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: POC_COALESCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a6b4d4e-4426-4b9e-af1a-c553e1edd275
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DT_MAJ_DATA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec2ae706-810d-42ca-8f19-07a958715e65
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3bf6edb-184f-4113-8d3a-b41069162cc3
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DT_BATCH_IMPORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddde1226-cc71-450e-b73b-bb35e262955b
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bb30c6c-1676-436d-8068-d99ac5ae7387
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DT_EXECUTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddef3cd6-c74d-4a7c-85a4-368c442dee31
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c42391-aec8-4076-b66e-880ddb96840a
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: AUDIT_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 179b0475-4bb6-47cf-aecf-a8933fde81c6
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa1d25b7-73eb-45ff-8c4d-5f847a07e60b
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ID_CHAR_PER_OBJECT_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b14d9786-ae25-493d-9e8f-77063cdfb528
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d1e6aa4-35c2-4827-830e-aad2dbb1b6b6
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ID_OBJECT_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1fa2c0d-569a-4927-bfae-3a0f77cf0fb6
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2cfe0b4-4df1-47c0-af81-21365d151f36
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: key_service
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a79f0592-ceab-45f6-a496-d3db05fbbab6
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e1e27cf-dcfe-4684-af26-d9f92b9e73d6
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ID_CHAR_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fa18951-7f41-41df-af73-6c26d86d4dba
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2410400-52fe-405e-86a6-78e2a8791584
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2836ae9-87b9-468b-b892-fccda04996f8
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d459deb8-b8be-40ca-add0-020c77f9286f
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: id_type
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d91d1ece-d2ef-45f0-be93-8d66599d1a9f
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: |-
              CASE 
                  WHEN "CHARACTERISTIC_PER_OBJECT"."DS_CHAR_NAME" = 'PM_SRV_ONE03' THEN 'Studies'
                  WHEN "CHARACTERISTIC_PER_OBJECT"."DS_CHAR_NAME" = 'PM_SRV_ONE04' THEN 'Works'
                  ELSE "CHARACTERISTIC_PER_OBJECT"."DS_CHAR_NAME"
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5192f5bf-bbba-4fdc-a956-9b0509b55939
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: DS_CHAR_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d64cb0-85fa-4e02-9564-2ee9b9f9e47f
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4df615b1-7111-494d-a2e2-ff298fb4e246
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ID_CHAR_OPTION_CAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4091aba-bc0d-4a1f-a21a-b489b88bd509
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47928cc9-d7ba-47f3-b798-120fe0c5c97e
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: ID_CHAR_OPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5fdc38b-53e2-4521-ae93-4d8928f5151c
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf84a159-9961-4c26-93f9-6edb8461005e
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: DS_CHAR_OPTION_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38d8504d-b32c-42b4-bc13-a14abe56ed42
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb8e24ad-c168-441d-95af-8304d120de7f
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_COUNTER_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a11499bc-247d-4b66-ab6b-9387f8036a23
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d8040bd-2cf1-4692-b6f1-a3162b3fff01
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ID_OBJECT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e111a7e6-ba3a-4141-8e03-36e5f0b35478
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54061322-4826-4790-89bb-c8ce6a17655c
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(11)
        description: ""
        name: DS_OBJECT_TABLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5272ace1-c6ed-4e8f-a872-c0d02c929a97
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd9525ac-d08d-4440-b8c8-51c95f45d2f2
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: DS_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f501aa63-b8d0-4cbd-92b1-b6fa3e01f606
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b80024b7-1c2e-448c-bc54-d5b960ca9fc4
          stepCounter: b2ee19a7-6ecf-44c2-8959-934be8002105
        config: {}
        dataType: FLOAT
        description: ""
        name: montant
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aa52fee-826e-4622-80e2-86e6a2d24bb3
                stepCounter: 102edc88-0825-44d3-993b-85cd68cf499e
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CHARACTERISTIC_PER_OBJECT: 102edc88-0825-44d3-993b-85cd68cf499e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: CAP_PRO
            nodeName: CHARACTERISTIC_PER_OBJECT
        join:
          joinCondition: FROM {{ ref('CAP_PRO', 'CHARACTERISTIC_PER_OBJECT') }} "CHARACTERISTIC_PER_OBJECT"
        name: STG_CHARACTERISTIC_PER_OBJECT
        noLinkRefs: []
  name: STG_CHARACTERISTIC_PER_OBJECT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
